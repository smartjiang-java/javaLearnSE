性能指标
一般包括：吞吐量、延迟、并发、资源占用等方面。这些指标构成一个整体，不可分割。
吞吐量：QPS/TPS
延迟：RT（response time）,响应时间
并发：用户数，一般用户量和吞吐量成正比，用户量越大，吞吐量越高
资源：load/利用率（CPU/MEM/DISK/NET）
 
load指标：系统负载（system load)：系统CPU繁忙程度的度量，即有多少进城在等待被CPU调度（进城等待队列的长度）
               与CPU核数有关，一般的CPU高，load高。如果load高，cpu低，说明瓶颈不是cpu,可能是程序一直在gc,也可能是下游处理不过来
        1分钟内：参考意义不打，有可能是系统抖动造成的，有偶然性
        5分钟内的：
       15分钟内的：一般看15分钟内的

压测-做性能度量
压测的目的：稳定性，可靠性，资源调度，成本优化
压测的方法：
   场景：性能基线压测（成本优化），单链路压测（秒杀），全链路压测（考核集群的能力）
   类型：脉冲型压测（流量从很小突然到很大，去检验一下缓存有没有预热），持续性压测（流量逐渐加大的情况下，能不能扛得动）
 稳定性保障：
     1：流量评估，会有多少流量进来，从几大链路做评估，比如交易处，入口处，依赖域
     2：基线压测
     3：容量评估：自己应用容量，中间件容量，db容量，系统保护（fast fail），系统预案（开关：管理等，做一些扩展）
fast fail：快速失败，反应不过来了，快速让其失败
     4：抖一下：最常见的是线程池满，先止血

问题一：大型系统的高并发设计
系统优化漏斗法则--读  
 最关键的是：挡流量，前面能挡多少挡多少，富客户端，然后是缓存，缓存的瓶颈是缓存量和热点数据（网卡）

行级锁优化-写（资源竞争）
合并同类项：多个请求合成一个，弊端是合并同类项的请求具有原子性，选择在db合并，等待时间变长
精简事务：牺牲一部分业务，减少sql；减少RT，sql事务自动开启，不让应用来开启；select from update，在一个事务中取
削峰填谷：账务，记流水，用户体验的不好
分而治之：做限流,弄一个时间环,识别热点
隔离:单独配置从库,并加上fast fail，不涉及总体业务

问题二：iWatch 高性能的秘密
大分页到后面RT会很多
B+树的快速扫描：mysql本身多层，有一个回表的操作；iWatch 采用ID有序
RPC非阻塞通信：










  






















